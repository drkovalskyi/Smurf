
For processes where the final states involving $\mu^+\mu^-$, $e^{\pm}\mu^{\mp}$ and $e^+e^-$ occur at equal 
rates, we can estimate the yields in the signal region (same flavor di-leptons) by counting 
opposite flavor di-lepton events. This method can be used to estimate backgrounds from top (including $\ttbar$ and $\tw$), 
$\WW$, and $\ztt$, as well as $\wz$ and $\zz$ when the selected same flavor leptons do not come from the same 
$Z$ boson. Since the non-resonant contributions from $\wz$ and $\zz$ are small, we estimate these backgrounds
fully from Monte Carlo simulation. Hence, we restrict the scope of the opposite flavor method to
evaluating the contamination from top, $\WW$ and $\ztt$.

The method begins with a control sample of opposite flavor di-lepton events. The selection criteria are 
identical to those used for signal extraction except for the requirement that the final state is $e\mu$. 
The opposite flavor events would then be selected with kinematics and event variables that mimic the conditions
in which we select same flavor events. The predicted same flavor yields are determined from the opposite flavor yields as follows:

\begin{equation}
N_{ee} + N_{\mu\mu} = \frac{1}{2}N_{e\mu}\left(\frac{\varepsilon_{e}}{\varepsilon_{\mu}} + \frac{\varepsilon_{\mu}}{\varepsilon_{e}}\right),
\end{equation}

where $\varepsilon_{e}$ and $\varepsilon_{\mu}$ are the selection and reconstruction efficiencies for electrons and muons
respectively. The efficiencies are derived from $Z\rightarrow\ell\ell$ simulation using Tag-and-Probe and binned into barrel and endcap in order
to account for the different kinematics of the various backgrounds. 

There are contributions to the control sample in data from processes other than top, $\WW$, and $\ztt$; these are $\wz$, $\zz$ and 
$W+$jets. The $\wz$ and $\zz$ events are adequately modeled in the Monte Carlo and the yields are expected to be small and are neglected here. The $W+$jets backgrounds are negligible as well (see Section~\ref{sec:bkg_fakes}).

\subsubsection{Closure test in Monte Carlo simulation}

To check on the validity of the flavor symmetry assumption of top, $\WW$, and $\ztt$, a closure test is performed using 
Monte Carlo simulation. The test is to make a direct prediction of the $ee$ and $\mu\mu$ background in the signal 
region using opposite flavor events. This test is done at the level of the $m_H=250$ cut based selection.
The results are summarised in Table \ref{tab:ofmc}. We find agreement between the predicted and observed yields
at the $5\%$ level.

%%%%%%%%%%%%%
\begin{table}[!ht]
\begin{center}
\begin{tabular}{c|c|c|c|c}
\hline
Sample   & $e\mu$ scaled to $\mu\mu$ & $\mu\mu$ & $e\mu$ scaled to $ee$ &  $ee$ Yield \\ \hline 
\hline
WW   & $13.60 \pm 0.39$ & $14.26 \pm 0.52$ & $10.18 \pm 0.29$ & $10.69 \pm 0.45$\\ \hline 
Top   & $16.10 \pm 0.38$ & $17.27 \pm 0.52$ & $12.24 \pm 0.29$ & $12.32 \pm 0.45$\\ \hline 
\end{tabular}
\caption{Results of the closure test performed at the $m_H=250$ selection level.
The $e\mu$ yields are scaled according to the measured lepton selection efficiencies 
to predict the $ee$ and $\mu\mu$ yields.}
\label{tab:ofmc}
\end{center}
\end{table}
%%%%%%%%%%%%%

\subsubsection{Application in $M_T$ Shape Analysis}

The shape for the non-resonant backgrounds dominated by top, WW processes
are taken from data using $e\mu$ events using the method described in
the previous section.
To produce a reliable shape from the limited number of $e\mu$ events passing the 
analysis selection in data, the $M_{T}$ shape obtained is smoothed using the method described in 
Reference~\cite{SMOOTHING}.
More details of this aspect of the shape analysis can be found in Reference~\cite{shapeananote}.


